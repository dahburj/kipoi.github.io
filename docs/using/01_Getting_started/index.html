<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Getting started - Kipoi Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Getting started";
    var mkdocs_page_input_path = "using/01_Getting_started.md";
    var mkdocs_page_url = "/using/01_Getting_started/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-115025493-1', 'kipoi.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Kipoi Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Using</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Getting started</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#using-kipoi-getting-started">Using Kipoi - Getting started</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#steps">Steps</a></li>
        
            <li><a class="toctree-l4" href="#python-quick-start">Python - quick start</a></li>
        
            <li><a class="toctree-l4" href="#command-line-interface-quick-start">Command-line interface - quick start</a></li>
        
            <li><a class="toctree-l4" href="#r-quick-start">R - quick start</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../02_Variant_effect_prediction/">Variant effect predictions</a>
                </li>
                <li class="">
                    
    <a class="" href="../03_Model_sources/">Private and public model sources</a>
                </li>
                <li class="">
                    
    <a class="" href="../04_Installing_on_OSX/">Installing on OSX</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Postprocessing</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../postprocessing/variant_effect_prediction/">Variant effect prediction</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Contributing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../contributing/01_Getting_started/">Getting started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contributing/02_Writing_model.yaml/">model.yaml</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contributing/04_Writing_dataloader.py/">dataloader.py</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contributing/03_Writing_dataloader.yaml/">dataloader.yaml</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contributing/05_Writing_model.py/">model.py</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contributing/06_dumping_models_programatically/">Multiple very similar models</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../tutorials/contributing_models/">Contributing models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/python-api/">Python API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/R-api/">R API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/tf_binding_models/">Comparing models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/composing_models/">Composing models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/variant_effect_prediction/">Variant effect prediction</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Api</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/model/">Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/dataloader/">Dataloader</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/pipeline/">Pipeline</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/metadata/">Metadata</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/remote/">Remotes</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Postprocessing</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../api/postprocessing/variant_effects/">Variant effect prediction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../api/postprocessing/variant_effect_scores/">Variant effect scores</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Kipoi Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Using &raquo;</li>
        
      
    
    <li>Getting started</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="http://github.com/kipoi/kipoi/edit/master/docs/templates/using/01_Getting_started.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="using-kipoi-getting-started">Using Kipoi - Getting started</h2>
<h3 id="steps">Steps</h3>
<h4 id="1-install-kipoi">1. Install Kipoi</h4>
<ol>
<li>Install <a href="https://conda.io/miniconda.html">miniconda</a> or <a href="https://www.anaconda.com/download">anaconda</a></li>
<li>Install git and git-lfs<ul>
<li>See how to install git <a href="https://www.atlassian.com/git/tutorials/install-git">here</a> or install it through conda: <code>conda install -c anaconda git</code></li>
<li>Install git-lfs: <code>conda install -c conda-forge git-lfs &amp;&amp; git lfs install</code></li>
<li>For alternative installation options  see <a href="https://git-lfs.github.com/">https://git-lfs.github.com/</a>.</li>
</ul>
</li>
<li>Install kipoi<ul>
<li><code>pip install kipoi</code></li>
<li>if you wish to use variant effect prediction, run <code>pip install kipoi[vep]</code></li>
</ul>
</li>
</ol>
<h4 id="2-choose-the-model-from-httpkipoiorgmodels">2. Choose the model from <a href="http://kipoi.org/groups">http://kipoi.org/models</a></h4>
<ol>
<li>Navigate to <a href="http://kipoi.org/groups">http://kipoi.org/models</a> and select a model of your interest</li>
<li>On model's page (<code>http://kipoi.org/models/&lt;model&gt;</code>), check the required arguments in the dataloader section and copy the code snippets</li>
</ol>
<h4 id="3-use-the-model">3. Use the model</h4>
<p>You can use the model from:</p>
<ul>
<li>Python</li>
<li>Command-line interface</li>
<li>R (via the <a href="https://github.com/rstudio/reticulate">reticulate</a> package)</li>
</ul>
<hr />
<h3 id="python-quick-start">Python - quick start</h3>
<p>See the ipython notebook <a href="../../tutorials/python-api/">tutorials/python-api</a> for additional information and a working example of the API. Here is a list of most useful python commands.</p>
<pre><code class="python">import kipoi
</code></pre>

<h4 id="list-all-models">List all models</h4>
<pre><code class="python">kipoi.list_models()
</code></pre>

<h4 id="get-the-model">Get the model</h4>
<pre><code class="python">model = kipoi.get_model(&quot;rbp_eclip/UPF1&quot;)
</code></pre>

<h4 id="access-information-about-the-model">Access information about the model</h4>
<pre><code class="python">model.info # Information about the author:

model.default_dataloader # Access the default dataloader

model.model # Access the underlying Keras model
</code></pre>

<h4 id="test-the-model">Test the model</h4>
<pre><code class="python">pred = model.pipeline.predict_example()
</code></pre>

<h4 id="get-predictions-for-the-raw-files">Get predictions for the raw files</h4>
<p>For any generation of the model output the dataloader has to be executed first. A dataloader will require input arguments in which the input files are defined, for example input fasta files or bed files, based on which the model input is generated. One way to display the keyword arguments a dataloader accepts is the following:</p>
<pre><code class="python">model.default_dataloader.print_args()
</code></pre>

<p>The output of the function above will tell you which arguments you can use when running the following command. Alternatively, you can view the dataloader arguments on the model's website (<code>http://kipoi.org/models/&lt;model&gt;</code>). Let's assume that <code>model.default_dataloder.print_args()</code> has informed us that the dataloader accepts the arguments <code>dataloader_arg1</code> and <code>targets_file</code>. You can get the model prediction using <code>kipoi.pipeline.predict</code>:</p>
<pre><code class="python">model.pipeline.predict({&quot;dataloader_arg1&quot;: &quot;...&quot;, &quot;targets_file&quot;: &quot;...&quot;})
</code></pre>

<p>Specifically, for the <code>rbp_eclip/UPF1</code> model, you would run the following:</p>
<pre><code class="python"># Make sure we are in the directory containing the example files
import os
os.chdir(os.path.expanduser('~/.kipoi/models/rbp_eclip/UPF1'))

# Run the prediction
model.pipeline.predict({'intervals_file': 'example_files/intervals.bed', 
                        'fasta_file': 'example_files/hg38_chr22.fa', 
                    'gtf_file': 'example_files/gencode.v24.annotation_chr22.gtf', 
                    'filter_protein_coding': True, 
                    'target_file': 'example_files/targets.tsv'})
</code></pre>

<h4 id="setup-the-dataloader">Setup the dataloader</h4>
<pre><code class="python">dl = model.default_dataloader(dataloader_arg1=&quot;...&quot;, targets_file=&quot;...&quot;)
</code></pre>

<p>Note: <code>kipoi.get_model("&lt;mymodel&gt;").default_dataloader</code> is the same as <code>kipoi.get_dataloader_factory("&lt;mymodel&gt;")</code></p>
<h4 id="predict-for-a-single-batch">Predict for a single batch</h4>
<pre><code class="python"># Get the batch iterator
it = dl.batch_iter(batch_size=32)

# get a single batch
single_batch = next(it)

# Make a prediction
predictions = model.predict_on_batch(single_batch['inputs'])
</code></pre>

<h4 id="re-train-the-model">Re-train the model</h4>
<pre><code class="python">it_train = dl.batch_train_iter(batch_size=32)  # will yield tuples (inputs, targets) indefinitely

# Since we are using a Keras model, run:
model.model.fit_generator(it_train, steps_per_epoch=len(dl)//32, epochs=10)
</code></pre>

<hr />
<h3 id="command-line-interface-quick-start">Command-line interface - quick start</h3>
<h4 id="show-help">Show help</h4>
<pre><code class="bash">kipoi -h
</code></pre>

<h4 id="list-all-models_1">List all models</h4>
<pre><code class="bash">kipoi ls
</code></pre>

<h4 id="get-information-on-how-the-required-dataloader-keyword-arguments">Get information on how the required dataloader keyword arguments</h4>
<pre><code class="bash">kipoi info -i --source kipoi rbp_eclip/UPF1
</code></pre>

<h4 id="run-model-prediction">Run model prediction</h4>
<pre><code class="bash">cd ~/.kipoi/models/rbp_eclip/UPF1/example_files

kipoi predict rbp_eclip/UPF1 \
  --dataloader_args='{'intervals_file': 'intervals.bed', 'fasta_file': 'hg38_chr22.fa', 'gtf_file': 'gencode.v24.annotation_chr22.gtf'}' \
  -o '/tmp/rbp_eclip__UPF1.example_pred.tsv'

# check the results
head '/tmp/rbp_eclip__UPF1.example_pred.tsv'
</code></pre>

<h4 id="test-a-model">Test a model</h4>
<pre><code class="bash">kipoi test ~/.kipoi/models/rbp_eclip/UPF1/example_files
</code></pre>

<h4 id="install-all-model-dependencies">Install all model dependencies</h4>
<pre><code class="bash">kipoi env install rbp_eclip/UPF1
</code></pre>

<h4 id="create-a-new-conda-environment-for-the-model">Create a new conda environment for the model</h4>
<pre><code class="bash">kipoi env create rbp_eclip/UPF1
source activate kipoi-rbp_eclip__UPF
</code></pre>

<h4 id="list-all-kipoi-environments">List all Kipoi environments</h4>
<pre><code class="bash">kipoi env list
</code></pre>

<p>Use <code>source activate &lt;env&gt;</code> or <code>conda activate &lt;env&gt;</code> to activate the environment.</p>
<h4 id="score-variants">Score variants</h4>
<pre><code class="bash">kipoi postproc score_variant rbp_eclip/UPF1 \
    --batch_size=16 \
    -v input.vcf \
    -o output.vcf
</code></pre>

<h3 id="r-quick-start">R - quick start</h3>
<p>See <a href="../../tutorials/R-api/">tutorials/R-api</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../02_Variant_effect_prediction/" class="btn btn-neutral float-right" title="Variant effect predictions">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../.." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="http://github.com/kipoi/kipoi/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../.." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../02_Variant_effect_prediction/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
